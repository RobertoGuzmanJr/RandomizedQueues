import java.util.Iterator;
import edu.princeton.cs.algs4.StdRandom;

public class Deque<Item> implements Iterable<Item> {	
	private int _size;
	private Node<Item> _front;
	private Node<Item> _back;	
	
	//inner class for linkedlist implementation
	public class Node<Item>
	{
		public Item value;
		public Node<Item> next;
		public Node<Item> previous;
	}
	
	// construct an empty deque
	public Deque()
	{
		_size = 0;
	}
	
	// is the deque empty?
	public boolean isEmpty()
	{
		return (_size == 0);
	}
	
	// return the number of items on the deque
	public int size()
	{
		return _size;
	}	
	
	// add the item to the front
	public void addFirst(Item item)
	{
		Node<Item> newItem = new Node<Item>();
		newItem.value = item;
		if(isEmpty())
		{
			_front = newItem;
			_back = newItem;
		}
		else
		{
			_front.next = newItem;
			newItem.previous = _front;
			_front = newItem;
		}
		_size++;
	}
	
	// add the item to the end
	public void addLast(Item item)
	{
		Node<Item> newItem = new Node<Item>();
		newItem.value = item;
		if(isEmpty())
		{
			_front = newItem;
			_back = newItem;
		}
		else
		{
			_back.previous = newItem;
			newItem.next = _back;
			_back = newItem;
		}
		_size++;
	}
	
	// remove and return the item from the front
	public Item removeFirst()
	{
		if(!isEmpty())
		{
			_size--;
			Item result = _front.value;
			_front = _front.previous;
			_front.next = null;
			return result;
		}
		else
		{
			throw new java.util.NoSuchElementException("This is empty!");
		}
	}
	
	// remove and return the item from the end
	public Item removeLast()
	{
		if(!isEmpty())
		{
			_size--;
			Item result = _back.value;
			_back = _back.next;
			_back.previous = null;
			return result;
		}
		else
		{
			throw new java.util.NoSuchElementException("This is empty!");
		}
	}
	
	// return an iterator over items in order from front to end
	public Iterator<Item> iterator()
	{
		return new DequeIterator();
	}
	
	// inner class to deal with iterators
	private class DequeIterator implements Iterator<Item>
	{
		private Node<Item> _current;
		public boolean hasNext()
		{
			return (_current != null);
		}
		public void remove()
		{
			throw new java.lang.UnsupportedOperationException("This is not supported!");
		}
		public Item next()
		{
			if(hasNext())
			{
				throw new java.util.NoSuchElementException("No more items to return!");
			}
			Item item = _current.value;
			_current = _current.next;
			return item;
		}
	}
	
	// unit testing
	public static void main(String[] args)
	{
		DequeTester<Integer> tester = new DequeTester<Integer>();
		tester.RunAllTests();		
	}
}
